"use strict";(globalThis.webpackChunkdocs=globalThis.webpackChunkdocs||[]).push([[5408],{8453(e,r,n){n.d(r,{R:()=>t,x:()=>s});var i=n(6540);const o={},a=i.createContext(o);function t(e){const r=i.useContext(a);return i.useMemo(function(){return"function"==typeof e?e(r):{...r,...e}},[r,e])}function s(e){let r;return r=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:t(e.components),i.createElement(a.Provider,{value:r},e.children)}},9394(e,r,n){n.r(r),n.d(r,{assets:()=>l,contentTitle:()=>s,default:()=>h,frontMatter:()=>t,metadata:()=>i,toc:()=>c});const i=JSON.parse('{"id":"guides/error-handling","title":"Error Handling","description":"React Achievements provides comprehensive error handling with type-safe error classes and recovery strategies.","source":"@site/guides/error-handling.md","sourceDirName":"guides","slug":"/guides/error-handling","permalink":"/react-achievements/docs/guides/error-handling","draft":false,"unlisted":false,"editUrl":"https://github.com/dave-b-b/react-achievements/tree/main/docs/guides/error-handling.md","tags":[],"version":"current","sidebarPosition":5,"frontMatter":{"sidebar_position":5},"sidebar":"tutorialSidebar","previous":{"title":"Builder API","permalink":"/react-achievements/docs/guides/builder-api"},"next":{"title":"Data Portability","permalink":"/react-achievements/docs/guides/data-portability"}}');var o=n(4848),a=n(8453);const t={sidebar_position:5},s="Error Handling",l={},c=[{value:"Overview",id:"overview",level:2},{value:"Error Callback",id:"error-callback",level:2},{value:"Error Types",id:"error-types",level:2},{value:"AchievementStorageError",id:"achievementstorageerror",level:3},{value:"AchievementConfigurationError",id:"achievementconfigurationerror",level:3},{value:"AchievementValidationError",id:"achievementvalidationerror",level:3},{value:"Error Handling Patterns",id:"error-handling-patterns",level:2},{value:"Basic Error Handling",id:"basic-error-handling",level:3},{value:"Advanced Error Handling",id:"advanced-error-handling",level:3},{value:"Retry Logic",id:"retry-logic",level:3},{value:"Graceful Degradation",id:"graceful-degradation",level:2},{value:"Storage Failure",id:"storage-failure",level:3},{value:"Configuration Errors",id:"configuration-errors",level:3},{value:"Network Failures (REST API)",id:"network-failures-rest-api",level:3},{value:"Type Guards",id:"type-guards",level:2},{value:"Error Properties",id:"error-properties",level:2},{value:"AchievementStorageError",id:"achievementstorageerror-1",level:3},{value:"AchievementConfigurationError",id:"achievementconfigurationerror-1",level:3},{value:"AchievementValidationError",id:"achievementvalidationerror-1",level:3},{value:"Best Practices",id:"best-practices",level:2},{value:"1. Always Provide onError Callback",id:"1-always-provide-onerror-callback",level:3},{value:"2. Log Errors to Monitoring Service",id:"2-log-errors-to-monitoring-service",level:3},{value:"3. Show User-Friendly Messages",id:"3-show-user-friendly-messages",level:3},{value:"4. Implement Fallback Storage",id:"4-implement-fallback-storage",level:3},{value:"Debugging",id:"debugging",level:2},{value:"Enable Detailed Logging",id:"enable-detailed-logging",level:3},{value:"Common Issues and Solutions",id:"common-issues-and-solutions",level:3},{value:"&quot;LocalStorage quota exceeded&quot;",id:"localstorage-quota-exceeded",level:4},{value:"&quot;Achievement not unlocking&quot;",id:"achievement-not-unlocking",level:4},{value:"&quot;Notifications not appearing&quot;",id:"notifications-not-appearing",level:4},{value:"What&#39;s Next?",id:"whats-next",level:2}];function d(e){const r={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,a.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(r.header,{children:(0,o.jsx)(r.h1,{id:"error-handling",children:"Error Handling"})}),"\n",(0,o.jsx)(r.p,{children:"React Achievements provides comprehensive error handling with type-safe error classes and recovery strategies."}),"\n",(0,o.jsx)(r.h2,{id:"overview",children:"Overview"}),"\n",(0,o.jsx)(r.p,{children:"The library handles errors gracefully with:"}),"\n",(0,o.jsxs)(r.ul,{children:["\n",(0,o.jsxs)(r.li,{children:[(0,o.jsx)(r.strong,{children:"Type-safe error classes"})," for different failure modes"]}),"\n",(0,o.jsxs)(r.li,{children:[(0,o.jsx)(r.strong,{children:"onError callback"})," for centralized error handling"]}),"\n",(0,o.jsxs)(r.li,{children:[(0,o.jsx)(r.strong,{children:"Graceful degradation"})," - achievements continue working even if storage fails"]}),"\n",(0,o.jsxs)(r.li,{children:[(0,o.jsx)(r.strong,{children:"Recovery guidance"})," in error messages"]}),"\n"]}),"\n",(0,o.jsx)(r.hr,{}),"\n",(0,o.jsx)(r.h2,{id:"error-callback",children:"Error Callback"}),"\n",(0,o.jsx)(r.p,{children:"Handle all achievement-related errors in one place:"}),"\n",(0,o.jsx)(r.pre,{children:(0,o.jsx)(r.code,{className:"language-tsx",children:"<AchievementProvider\n  achievements={achievements}\n  onError={(error) => {\n    console.error('Achievement error:', error.message);\n    // Send to error tracking service\n    Sentry.captureException(error);\n  }}\n>\n  <YourApp />\n</AchievementProvider>\n"})}),"\n",(0,o.jsx)(r.hr,{}),"\n",(0,o.jsx)(r.h2,{id:"error-types",children:"Error Types"}),"\n",(0,o.jsx)(r.h3,{id:"achievementstorageerror",children:"AchievementStorageError"}),"\n",(0,o.jsx)(r.p,{children:"Thrown when storage operations fail (localStorage full, IndexedDB unavailable, etc.)."}),"\n",(0,o.jsx)(r.pre,{children:(0,o.jsx)(r.code,{className:"language-tsx",children:"try {\n  await storage.save(data);\n} catch (error) {\n  if (error instanceof AchievementStorageError) {\n    console.error('Storage failed:', error.message);\n    console.log('Recovery:', error.recoveryHint);\n  }\n}\n"})}),"\n",(0,o.jsx)(r.p,{children:(0,o.jsx)(r.strong,{children:"Common Causes:"})}),"\n",(0,o.jsxs)(r.ul,{children:["\n",(0,o.jsx)(r.li,{children:"localStorage quota exceeded"}),"\n",(0,o.jsx)(r.li,{children:"IndexedDB not available"}),"\n",(0,o.jsx)(r.li,{children:"Network failure (REST API storage)"}),"\n",(0,o.jsx)(r.li,{children:"Permission denied"}),"\n"]}),"\n",(0,o.jsx)(r.p,{children:(0,o.jsx)(r.strong,{children:"Recovery Hints:"})}),"\n",(0,o.jsx)(r.pre,{children:(0,o.jsx)(r.code,{children:'"Clear old data or switch to IndexedDB for more capacity"\n"Check browser settings - IndexedDB may be disabled"\n"Check network connection and retry"\n'})}),"\n",(0,o.jsx)(r.h3,{id:"achievementconfigurationerror",children:"AchievementConfigurationError"}),"\n",(0,o.jsx)(r.p,{children:"Thrown when achievement configuration is invalid."}),"\n",(0,o.jsx)(r.pre,{children:(0,o.jsx)(r.code,{className:"language-tsx",children:'// \u274c Invalid configuration\nconst achievements = {\n  score: {\n    100: { /* missing title */ }\n  }\n};\n\n// Error: AchievementConfigurationError\n// Message: "Achievement title is required"\n'})}),"\n",(0,o.jsx)(r.p,{children:(0,o.jsx)(r.strong,{children:"Common Causes:"})}),"\n",(0,o.jsxs)(r.ul,{children:["\n",(0,o.jsx)(r.li,{children:"Missing required fields (title, icon)"}),"\n",(0,o.jsx)(r.li,{children:"Invalid threshold values"}),"\n",(0,o.jsx)(r.li,{children:"Duplicate achievement IDs"}),"\n",(0,o.jsx)(r.li,{children:"Invalid condition functions"}),"\n"]}),"\n",(0,o.jsx)(r.h3,{id:"achievementvalidationerror",children:"AchievementValidationError"}),"\n",(0,o.jsx)(r.p,{children:"Thrown when achievement metrics fail validation."}),"\n",(0,o.jsx)(r.pre,{children:(0,o.jsx)(r.code,{className:"language-tsx",children:"track('score', 'invalid');  // Should be a number\n\n// Error: AchievementValidationError\n// Message: \"Metric 'score' expected number, got string\"\n"})}),"\n",(0,o.jsx)(r.p,{children:(0,o.jsx)(r.strong,{children:"Common Causes:"})}),"\n",(0,o.jsxs)(r.ul,{children:["\n",(0,o.jsx)(r.li,{children:"Wrong metric type (string instead of number)"}),"\n",(0,o.jsx)(r.li,{children:"NaN or Infinity values"}),"\n",(0,o.jsx)(r.li,{children:"Null/undefined values"}),"\n"]}),"\n",(0,o.jsx)(r.hr,{}),"\n",(0,o.jsx)(r.h2,{id:"error-handling-patterns",children:"Error Handling Patterns"}),"\n",(0,o.jsx)(r.h3,{id:"basic-error-handling",children:"Basic Error Handling"}),"\n",(0,o.jsx)(r.pre,{children:(0,o.jsx)(r.code,{className:"language-tsx",children:"import { useAchievements } from 'react-achievements';\n\nfunction MyComponent() {\n  const { update, error } = useAchievements();\n\n  const handleAction = () => {\n    try {\n      update({ score: 100 });\n    } catch (err) {\n      console.error('Failed to update achievement:', err);\n    }\n  };\n\n  if (error) {\n    return <div>Error: {error.message}</div>;\n  }\n\n  return <button onClick={handleAction}>Score Points</button>;\n}\n"})}),"\n",(0,o.jsx)(r.h3,{id:"advanced-error-handling",children:"Advanced Error Handling"}),"\n",(0,o.jsx)(r.pre,{children:(0,o.jsx)(r.code,{className:"language-tsx",children:"import {\n  AchievementStorageError,\n  AchievementConfigurationError,\n  AchievementValidationError\n} from 'react-achievements';\n\nfunction handleAchievementError(error: Error) {\n  if (error instanceof AchievementStorageError) {\n    // Storage failure - try fallback\n    console.warn('Storage failed, using memory storage');\n    // Switch to MemoryStorage\n    return { action: 'switch_storage', storage: 'memory' };\n  }\n\n  if (error instanceof AchievementConfigurationError) {\n    // Configuration error - fix and reload\n    console.error('Invalid configuration:', error.message);\n    return { action: 'fix_config' };\n  }\n\n  if (error instanceof AchievementValidationError) {\n    // Validation error - sanitize input\n    console.warn('Invalid metric value:', error.message);\n    return { action: 'sanitize_input' };\n  }\n\n  // Unknown error\n  console.error('Unknown achievement error:', error);\n  return { action: 'report' };\n}\n"})}),"\n",(0,o.jsx)(r.h3,{id:"retry-logic",children:"Retry Logic"}),"\n",(0,o.jsx)(r.pre,{children:(0,o.jsx)(r.code,{className:"language-tsx",children:"async function updateWithRetry(metrics, maxRetries = 3) {\n  let attempt = 0;\n\n  while (attempt < maxRetries) {\n    try {\n      await update(metrics);\n      return { success: true };\n    } catch (error) {\n      attempt++;\n\n      if (error instanceof AchievementStorageError && attempt < maxRetries) {\n        // Wait and retry\n        await new Promise(resolve => setTimeout(resolve, 1000 * attempt));\n        continue;\n      }\n\n      // Max retries reached or non-retryable error\n      return { success: false, error };\n    }\n  }\n}\n"})}),"\n",(0,o.jsx)(r.hr,{}),"\n",(0,o.jsx)(r.h2,{id:"graceful-degradation",children:"Graceful Degradation"}),"\n",(0,o.jsx)(r.p,{children:"React Achievements is designed to degrade gracefully when errors occur:"}),"\n",(0,o.jsx)(r.h3,{id:"storage-failure",children:"Storage Failure"}),"\n",(0,o.jsx)(r.p,{children:"When storage fails, achievements continue to work in memory:"}),"\n",(0,o.jsx)(r.pre,{children:(0,o.jsx)(r.code,{className:"language-tsx",children:"<AchievementProvider\n  achievements={achievements}\n  storage={StorageType.LocalStorage}\n  onError={(error) => {\n    if (error instanceof AchievementStorageError) {\n      // Automatically falls back to memory storage\n      console.warn('Switched to memory storage');\n    }\n  }}\n>\n  <YourApp />\n</AchievementProvider>\n"})}),"\n",(0,o.jsx)(r.h3,{id:"configuration-errors",children:"Configuration Errors"}),"\n",(0,o.jsx)(r.p,{children:"Invalid achievements are skipped, valid ones still work:"}),"\n",(0,o.jsx)(r.pre,{children:(0,o.jsx)(r.code,{className:"language-tsx",children:"const achievements = {\n  score: {\n    100: { title: 'Century', icon: '\ud83c\udfc6' },  // \u2705 Valid\n    500: { /* missing title */ }             // \u274c Skipped\n  }\n};\n\n// Only the valid achievement (100) will be tracked\n"})}),"\n",(0,o.jsx)(r.h3,{id:"network-failures-rest-api",children:"Network Failures (REST API)"}),"\n",(0,o.jsx)(r.p,{children:"Offline queue automatically stores updates locally:"}),"\n",(0,o.jsx)(r.pre,{children:(0,o.jsx)(r.code,{className:"language-tsx",children:"<AchievementProvider\n  achievements={achievements}\n  storage={StorageType.OfflineQueue}\n  storageConfig={{\n    apiEndpoint: '/api/achievements',\n    onSyncError: (error) => {\n      // Handle sync failures\n      console.error('Sync failed:', error);\n    }\n  }}\n>\n  <YourApp />\n</AchievementProvider>\n"})}),"\n",(0,o.jsx)(r.hr,{}),"\n",(0,o.jsx)(r.h2,{id:"type-guards",children:"Type Guards"}),"\n",(0,o.jsx)(r.p,{children:"Use type guards to safely check error types:"}),"\n",(0,o.jsx)(r.pre,{children:(0,o.jsx)(r.code,{className:"language-tsx",children:"import {\n  isAchievementStorageError,\n  isAchievementConfigurationError,\n  isAchievementValidationError\n} from 'react-achievements';\n\nfunction handleError(error: unknown) {\n  if (isAchievementStorageError(error)) {\n    console.log('Storage error:', error.recoveryHint);\n  } else if (isAchievementConfigurationError(error)) {\n    console.log('Config error:', error.message);\n  } else if (isAchievementValidationError(error)) {\n    console.log('Validation error:', error.message);\n  }\n}\n"})}),"\n",(0,o.jsx)(r.hr,{}),"\n",(0,o.jsx)(r.h2,{id:"error-properties",children:"Error Properties"}),"\n",(0,o.jsx)(r.h3,{id:"achievementstorageerror-1",children:"AchievementStorageError"}),"\n",(0,o.jsx)(r.pre,{children:(0,o.jsx)(r.code,{className:"language-tsx",children:"{\n  name: 'AchievementStorageError',\n  message: 'Failed to save to localStorage',\n  recoveryHint: 'Clear old data or switch to IndexedDB',\n  originalError: DOMException,  // The underlying error\n  storageType: 'localStorage'\n}\n"})}),"\n",(0,o.jsx)(r.h3,{id:"achievementconfigurationerror-1",children:"AchievementConfigurationError"}),"\n",(0,o.jsx)(r.pre,{children:(0,o.jsx)(r.code,{className:"language-tsx",children:"{\n  name: 'AchievementConfigurationError',\n  message: 'Achievement title is required',\n  achievementId: 'score_100',\n  field: 'title'\n}\n"})}),"\n",(0,o.jsx)(r.h3,{id:"achievementvalidationerror-1",children:"AchievementValidationError"}),"\n",(0,o.jsx)(r.pre,{children:(0,o.jsx)(r.code,{className:"language-tsx",children:"{\n  name: 'AchievementValidationError',\n  message: \"Metric 'score' expected number, got string\",\n  metricName: 'score',\n  expectedType: 'number',\n  receivedType: 'string',\n  receivedValue: 'invalid'\n}\n"})}),"\n",(0,o.jsx)(r.hr,{}),"\n",(0,o.jsx)(r.h2,{id:"best-practices",children:"Best Practices"}),"\n",(0,o.jsx)(r.h3,{id:"1-always-provide-onerror-callback",children:"1. Always Provide onError Callback"}),"\n",(0,o.jsx)(r.pre,{children:(0,o.jsx)(r.code,{className:"language-tsx",children:"// \u2705 Good: Centralized error handling\n<AchievementProvider\n  achievements={achievements}\n  onError={(error) => {\n    logToService(error);\n    showUserNotification(error.message);\n  }}\n>\n\n// \u274c Bad: No error handling\n<AchievementProvider achievements={achievements}>\n"})}),"\n",(0,o.jsx)(r.h3,{id:"2-log-errors-to-monitoring-service",children:"2. Log Errors to Monitoring Service"}),"\n",(0,o.jsx)(r.pre,{children:(0,o.jsx)(r.code,{className:"language-tsx",children:"<AchievementProvider\n  achievements={achievements}\n  onError={(error) => {\n    // Send to Sentry, LogRocket, etc.\n    Sentry.captureException(error, {\n      tags: {\n        component: 'achievements',\n        storage: error.storageType\n      },\n      extra: {\n        recoveryHint: error.recoveryHint\n      }\n    });\n  }}\n>\n"})}),"\n",(0,o.jsx)(r.h3,{id:"3-show-user-friendly-messages",children:"3. Show User-Friendly Messages"}),"\n",(0,o.jsx)(r.pre,{children:(0,o.jsx)(r.code,{className:"language-tsx",children:'function AchievementErrorBoundary({ error }) {\n  if (error instanceof AchievementStorageError) {\n    return (\n      <div className="error">\n        <p>Achievement progress couldn\'t be saved.</p>\n        <p>{error.recoveryHint}</p>\n        <button onClick={() => window.location.reload()}>\n          Retry\n        </button>\n      </div>\n    );\n  }\n\n  return <div>An unexpected error occurred.</div>;\n}\n'})}),"\n",(0,o.jsx)(r.h3,{id:"4-implement-fallback-storage",children:"4. Implement Fallback Storage"}),"\n",(0,o.jsx)(r.pre,{children:(0,o.jsx)(r.code,{className:"language-tsx",children:"function AppWithFallback() {\n  const [storage, setStorage] = useState(StorageType.LocalStorage);\n\n  return (\n    <AchievementProvider\n      achievements={achievements}\n      storage={storage}\n      onError={(error) => {\n        if (error instanceof AchievementStorageError) {\n          // Fallback to memory storage\n          setStorage(StorageType.Memory);\n        }\n      }}\n    >\n      <YourApp />\n    </AchievementProvider>\n  );\n}\n"})}),"\n",(0,o.jsx)(r.hr,{}),"\n",(0,o.jsx)(r.h2,{id:"debugging",children:"Debugging"}),"\n",(0,o.jsx)(r.h3,{id:"enable-detailed-logging",children:"Enable Detailed Logging"}),"\n",(0,o.jsx)(r.pre,{children:(0,o.jsx)(r.code,{className:"language-tsx",children:"<AchievementProvider\n  achievements={achievements}\n  debug={true}  // Logs all operations to console\n  onError={(error) => {\n    console.error('Achievement error:', error);\n    console.trace();  // Stack trace\n  }}\n>\n  <YourApp />\n</AchievementProvider>\n"})}),"\n",(0,o.jsx)(r.h3,{id:"common-issues-and-solutions",children:"Common Issues and Solutions"}),"\n",(0,o.jsx)(r.h4,{id:"localstorage-quota-exceeded",children:'"LocalStorage quota exceeded"'}),"\n",(0,o.jsx)(r.p,{children:(0,o.jsx)(r.strong,{children:"Solution:"})}),"\n",(0,o.jsx)(r.pre,{children:(0,o.jsx)(r.code,{className:"language-tsx",children:"// Switch to IndexedDB (50MB+ capacity)\n<AchievementProvider\n  achievements={achievements}\n  storage={StorageType.IndexedDB}\n>\n"})}),"\n",(0,o.jsx)(r.h4,{id:"achievement-not-unlocking",children:'"Achievement not unlocking"'}),"\n",(0,o.jsx)(r.p,{children:(0,o.jsx)(r.strong,{children:"Check:"})}),"\n",(0,o.jsxs)(r.ol,{children:["\n",(0,o.jsx)(r.li,{children:"Condition function is correct"}),"\n",(0,o.jsx)(r.li,{children:"Metric value is correct type"}),"\n",(0,o.jsx)(r.li,{children:"Achievement ID is unique"}),"\n",(0,o.jsx)(r.li,{children:"No configuration errors"}),"\n"]}),"\n",(0,o.jsx)(r.pre,{children:(0,o.jsx)(r.code,{className:"language-tsx",children:"// Enable debug mode to see all checks\n<AchievementProvider achievements={achievements} debug={true}>\n"})}),"\n",(0,o.jsx)(r.h4,{id:"notifications-not-appearing",children:'"Notifications not appearing"'}),"\n",(0,o.jsx)(r.p,{children:(0,o.jsx)(r.strong,{children:"Check:"})}),"\n",(0,o.jsxs)(r.ol,{children:["\n",(0,o.jsxs)(r.li,{children:[(0,o.jsx)(r.code,{children:"useBuiltInUI={true}"})," is set"]}),"\n",(0,o.jsx)(r.li,{children:"No JavaScript errors in console"}),"\n",(0,o.jsx)(r.li,{children:"Achievement is actually unlocking (check debug logs)"}),"\n"]}),"\n",(0,o.jsx)(r.hr,{}),"\n",(0,o.jsx)(r.h2,{id:"whats-next",children:"What's Next?"}),"\n",(0,o.jsxs)(r.ul,{children:["\n",(0,o.jsxs)(r.li,{children:[(0,o.jsx)(r.strong,{children:(0,o.jsx)(r.a,{href:"./data-portability",children:"Data Portability"})})," - Export/import for error recovery"]}),"\n",(0,o.jsxs)(r.li,{children:[(0,o.jsx)(r.strong,{children:(0,o.jsx)(r.a,{href:"../api-reference",children:"API Reference"})})," - Complete error class documentation"]}),"\n",(0,o.jsxs)(r.li,{children:[(0,o.jsx)(r.strong,{children:(0,o.jsx)(r.a,{href:"./theming",children:"Theming"})})," - Customize the UI appearance"]}),"\n"]})]})}function h(e={}){const{wrapper:r}={...(0,a.R)(),...e.components};return r?(0,o.jsx)(r,{...e,children:(0,o.jsx)(d,{...e})}):d(e)}}}]);